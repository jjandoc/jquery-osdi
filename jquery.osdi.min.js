!function(n){"use strict";"function"==typeof define&&define.amd?define(["jquery"],n):"undefined"!=typeof module&&module.exports?module.exports=n(require("jquery")):n(jQuery)}(function(n){"use strict";function t(t,a){this.$element=n(t),this.settings=n.extend({},i,a),this._defaults=i,this._name=e,this.init(this.$element),this.submit=function(){this.form_submit(this.$element,this)}}var e="osdi",i={autoresponse:!0,done:function(){},fail:function(){},always:function(){},status:"subscribed",immediate:!1,ajax_options:{type:"POST",dataType:"json",contentType:"application/json"}};n.extend(t.prototype,{init:function(n){this.validate_form(n)&&this.form_submit(n,this)},validate_form:function(n){return!!n.is("form")||(console.log("JQUERY OSDI ERROR: The DOM element passed to the jQuery OSDI plugin is not a form. The jQuery OSDI plugin only supports form elements."),!1)},form_submit:function(n,t){t.settings.immediate?t.submit_handler(n,t):n.on("submit",function(){return t.submit_handler(n,t),!1})},submit_handler:function(t,e){if(e.validate_submit(t)){var i,a,s,o,d;i=e.create_body(t),a={url:e.settings.endpoint&&""!=e.settings.endpoint?"function"==typeof e.settings.endpoint?e.settings.endpoint():e.settings.endpoint:t.attr("action"),data:JSON.stringify(i)},a="function"==typeof e.settings.ajax_options?n.extend(a,e.settings.ajax_options()):n.extend(a,e.settings.ajax_options),s=e.settings.done,o=e.settings.fail,d=e.settings.always,e.perform_ajax(a,s,o,d)}},validate_submit:function(n){return!(!this.validate_endpoint(n)||!this.validate_add_tags())},validate_endpoint:function(n){return!(!this.settings.endpoint&&!n.attr("action"))||(console.log("JQUERY OSDI ERROR: An endpoint is required. Either set the endpoint option with a string when calling the jQuery OSDI plugin, or give your form an action attribute with the endpoint as its value."),!1)},validate_add_tags:function(){return!this.settings.add_tags||("function"==typeof this.settings.add_tags?!(!n.isArray(this.settings.add_tags())||!this.settings.add_tags().length>0)||(console.log("JQUERY OSDI ERROR: The add_tags option is not a valid array of at least one element. You must pass an array with at least one element to the jQuery OSDI plugin to add tags."),!1):!(!n.isArray(this.settings.add_tags)||!this.settings.add_tags.length>0)||(console.log("JQUERY OSDI ERROR: The add_tags option is not a valid array of at least one element. You must pass an array with at least one element to the jQuery OSDI plugin to add tags."),!1))},create_body:function(t){var e,i,a,s,o,d,u,l;return this.settings.body?e="function"==typeof this.settings.body?this.settings.body():this.settings.body:(e={person:{}},"function"==typeof this.settings.autoresponse?!0===this.settings.autoresponse()&&(i={triggers:{autoresponse:{enabled:!0}}}):this.settings.autoresponse&&!0===this.settings.autoresponse&&(i={triggers:{autoresponse:{enabled:!0}}}),n.extend(e,i),this.settings.add_tags&&(l="function"==typeof this.settings.add_tags?{add_tags:this.settings.add_tags()}:{add_tags:this.settings.add_tags},n.extend(e,l)),t.find(':input[name="family_name"]').length&&t.find(':input[name="family_name"]').val()&&(e.person.family_name=n.isArray(t.find(':input[name="family_name"]').val())?t.find(':input[name="family_name"]').val().pop():t.find(':input[name="family_name"]').val()),t.find(':input[name="given_name"]').length&&t.find(':input[name="given_name"]').val()&&(e.person.given_name=n.isArray(t.find(':input[name="given_name"]').val())?t.find(':input[name="given_name"]').val().pop():t.find(':input[name="given_name"]').val()),t.find(':input[name="email_address"]').length&&t.find(':input[name="email_address"]').val()&&(a={email_addresses:[{address:n.isArray(t.find(':input[name="email_address"]').val())?t.find(':input[name="email_address"]').val().pop():t.find(':input[name="email_address"]').val()}]},n.extend(e.person,a),"function"==typeof this.settings.status?!1!==this.settings.status()&&(e.person.email_addresses[0].status=this.settings.status()):!1!==this.settings.status&&(e.person.email_addresses[0].status=this.settings.status)),(t.find(':input[name="street"]').length&&t.find(':input[name="street"]').val()||t.find(':input[name="locality"]').length&&t.find(':input[name="locality"]').val()||t.find(':input[name="region"]').length&&t.find(':input[name="region"]').val()||t.find(':input[name="postal_code"]').length&&t.find(':input[name="postal_code"]').val()||t.find(':input[name="country"]').length&&t.find(':input[name="country"]').val())&&(s={},t.find(':input[name="street"]').length&&t.find(':input[name="street"]').val()&&(s.address_lines=[n.isArray(t.find(':input[name="street"]').val())?t.find(':input[name="street"]').val().pop():t.find(':input[name="street"]').val()]),t.find(':input[name="locality"]').length&&t.find(':input[name="locality"]').val()&&(s.locality=n.isArray(t.find(':input[name="locality"]').val())?t.find(':input[name="locality"]').val().pop():t.find(':input[name="locality"]').val()),t.find(':input[name="region"]').length&&t.find(':input[name="region"]').val()&&(s.region=n.isArray(t.find(':input[name="region"]').val())?t.find(':input[name="region"]').val().pop():t.find(':input[name="region"]').val()),t.find(':input[name="postal_code"]').length&&t.find(':input[name="postal_code"]').val()&&(s.postal_code=n.isArray(t.find(':input[name="postal_code"]').val())?t.find(':input[name="postal_code"]').val().pop():t.find(':input[name="postal_code"]').val()),t.find(':input[name="country"]').length&&t.find(':input[name="country"]').val()&&(s.country=n.isArray(t.find(':input[name="country"]').val())?t.find(':input[name="country"]').val().pop():t.find(':input[name="country"]').val()),o={postal_addresses:[s]},n.extend(e.person,o)),t.find(':input[name="phone_number"]').length&&t.find(':input[name="phone_number"]').val()&&(d={phone_numbers:[{number:n.isArray(t.find(':input[name="phone_number"]').val())?t.find(':input[name="phone_number"]').val().pop():t.find(':input[name="phone_number"]').val()}]},n.extend(e.person,d)),t.find(':input[name^="custom["]').length&&(u={},n.each(t.find(':input[name^="custom["]').serializeArray(),function(){""!=this.value&&(u[this.name.replace(/^custom\[|\]$/g,"")]=this.value)}),n.isEmptyObject(u)||(e.person.custom_fields=u))),e},perform_ajax:function(t,e,i,a){n.ajax(t).done(function(n,t,i){e(n,t,i)}).fail(function(n,t,e){i(n,t,e)}).always(function(n,t,e){a(n,t,e)})}}),n.fn[e]=function(i){return this.each(function(){n.data(this,"plugin_"+e)?n.data(this,"plugin_"+e).submit():n.data(this,"plugin_"+e,new t(this,i))})}});